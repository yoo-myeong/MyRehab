# MyRehab

## 👉 목적

**웹**, **스마트매트**, **컨트롤러**를 사용해 자가 재활 치료를 보조하여 부족한 재활 시설 인프라 환경에 기여

<br>

## 🔎 프로젝트 개요

 
### 구성
+ Web
  + 웹캠으로 입력되는 사용자의 자세를 머신러닝한 모델을 기반으로 분석하여 자세의 정확성을 판단 
  + 재활 게임 제공 
  + 커뮤니티를 통해 사용자 간 재활에 관한 정보를 공유
+ 스마트매트
  + 매트의 LED를 점등하여 다음 동작을 안내하고, 각 지점에 부착된 압력센서로 사용자의 균형을 측정하여 자세를 교정
+ 컨트롤러 
  + MPU6050을 부착해 roll, pitch, yaw를 측정해서 자세 교정과 손목 재활 게임에 활용 
  + 사용자가 버튼을 누르는 힘을 압력센서로 측정해서 손가락 재활 게임에 활용

 
<br>

## 📹 시연영상

클릭하면 유튜브로 이동 ⬇

[![MyRehab_시연영상](http://img.youtube.com/vi/qF2fW21TfUo/0.jpg)](https://youtu.be/qF2fW21TfUo?t=0s) 

<br>

## 🧐 자세한 개발 내용

[Web](./web.md)

[SmartMat](./smartmat.md)

[Controller](./controller.md)

<br>

## 🔨 문제해결

+ **firebase update 속도 개선**

   IoT 제품과 웹은 공유해야 하는 데이터를 firebase realtime DB에 업데이트했습니다. 모든 데이터가 키를 갖고 업데이트되더라도 충분히 빠른 속도로 동작할 것이라고 예상했습니다. IoT 제품은 아두이노로 제작했는데 esp8266 라이브러리를 사용해서 firebaseDB에 업데이트시켰습니다. 이 업데이트는 한 번 동작할 때마다 약 1초가 걸렸고, 모든 데이터가 업데이트를 완료하려면 총 20초가 소요됐습니다. <br>
 실사용이 가능한 제품을 개발하기 위해서는 20초의 시간을 최소한 1초까지 단축해야 했습니다. 팀원들과 여러 가지 방법을 모색하고 의견을 나눈 뒤 javascript의 json.parse()를 사용해서 문자열을 파싱하는 방법이 가장 적합하다고 판단했습니다. 예를 들어 압력 데이터의 경우 24개의 값을 “[200, 123, 50, 0, 0, …]”과 같은 문자열로 만들어서 ‘PRESS’ 키에 업데이트합니다. 웹에서는 ‘PRESS’ 키의 문자열을 가져온 뒤 파싱해서 배열로 변환하고 2차 자세 분석에 활용합니다. 모든 업데이트 동작에 이 방법을 적용했고 약 1초마다 사용자의 자세를 분석하는 제품을 완성할 수 있었습니다.
